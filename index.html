<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Daily Wordle</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

  html, body {
    margin: 0;
    padding: 0;
    height: 100%;
    font-family: 'Inter', sans-serif;
    background: var(--bg);
    color: var(--text);
    transition: background 0.3s, color 0.3s;
    overflow: hidden;
    display: flex;
    flex-direction: column;
  }

  :root {
    --bg: #f7f7f7;
    --text: #111;
    --tile-bg: #fff;
    --tile-border: #d3d6da;
    --key-bg: #d3d6da;
    --key-text: #111;
    --key-hover: #bbb;
    --special-bg: #4cafef;
    --special-hover: #3a8cd8;
  }

  body.dark {
    --bg: #121213;
    --text: #eee;
    --tile-bg: #1d1d1f;
    --tile-border: #3a3a3c;
    --key-bg: #3a3a3c;
    --key-text: #fff;
    --key-hover: #555;
    --special-bg: #4cafef;
    --special-hover: #3a8cd8;
  }

  /* Header */
  header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 30px;
    background: var(--tile-bg);
    box-shadow: 0 2px 8px rgba(0,0,0,0.05);
    flex-shrink: 0;
  }
  header h1 {
    margin: 0;
    font-size: 2rem;
    font-weight: 700;
  }
  #theme-toggle {
    padding: 8px 16px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    background: var(--special-bg);
    color: white;
    transition: 0.3s;
  }
  #theme-toggle:hover { background: var(--special-hover); }

  /* Main game area */
  .game-wrapper {
    flex: 1;
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 50px;
    padding: 20px;
    box-sizing: border-box;
  }

  /* Board */
  #board {
    display: grid;
    grid-template-rows: repeat(6, 1fr);
    gap: 10px;
  }
  .row {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 8px;
  }
  .tile {
    width: 60px; height: 60px;
    border: 2px solid var(--tile-border);
    display: flex; align-items: center; justify-content: center;
    font-size: 24px; font-weight: 700;
    border-radius: 6px;
    text-transform: uppercase;
    background: var(--tile-bg);
    transition: 0.3s all;
  }
  .tile.filled { transform: scale(1.05); }
  .correct { background: #6aaa64; color: white; border: none; }
  .present { background: #c9b458; color: white; border: none; }
  .absent { background: #787c7e; color: white; border: none; }

  /* Keyboard */
  .keyboard-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    gap: 15px;
  }
  #keyboard { display: flex; flex-direction: column; gap: 8px; }
  .keyboard-row { display: flex; justify-content: center; gap: 6px; }
  #keyboard button {
    padding: 14px 16px;
    border: none; border-radius: 6px;
    font-weight: 600; cursor: pointer;
    background: var(--key-bg); color: var(--key-text);
    min-width: 40px; transition: 0.2s;
  }
  #keyboard button:hover { background: var(--key-hover); }
  #keyboard .special {
    background: var(--special-bg);
    color: white; padding: 14px 24px;
  }
  #keyboard .special:hover { background: var(--special-hover); }

  /* Message */
  #message {
    font-size: 18px;
    font-weight: 600;
    min-height: 28px;
    text-align: center;
  }

  /* Countdown Timer */
  #countdown {
    font-size: 16px;
    font-weight: 600;
    text-align: center;
    padding: 10px 20px;
    background: var(--tile-bg);
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0,0,0,0.1);
    margin-bottom: 10px;
  }

</style>
</head>
<body>
  <header>
    <h1>Daily Wordle</h1>
    <button id="theme-toggle">üåô Dark Mode</button>
  </header>

  <div class="game-wrapper">
    <div id="board"></div>
    <div class="keyboard-container">
      <div id="countdown">Next word in: --:--:--</div>
      <div id="keyboard">
        <div class="keyboard-row"><button>A</button><button>B</button><button>C</button><button>D</button><button>E</button><button>F</button><button>G</button><button>H</button><button>I</button></div>
        <div class="keyboard-row"><button>J</button><button>K</button><button>L</button><button>M</button><button>N</button><button>O</button><button>P</button><button>Q</button><button>R</button></div>
        <div class="keyboard-row"><button>S</button><button>T</button><button>U</button><button>V</button><button>W</button><button>X</button><button>Y</button><button>Z</button></div>
        <div class="keyboard-row"><button class="special" id="enter">Enter</button><button class="special" id="backspace">‚å´</button></div>
      </div>
      <div id="message"></div>
    </div>
  </div>

  <script>
    let wordOfTheDay = "";
    let currentRow = 0, currentTile = 0, gameOver = false;
    const board = document.getElementById("board");
    const message = document.getElementById("message");
    const countdownElement = document.getElementById("countdown");
    
    // Fetch words from JSON and pick the word of the day (based on IST)
    async function getWordOfTheDay() {
      try {
        const response = await fetch("words.json");
        const data = await response.json();
        const words = data.words;
    
        // Get current IST date
        const nowUTC = new Date();
        const istOffset = 5.5 * 60; // IST is UTC +5:30
        const nowIST = new Date(nowUTC.getTime() + istOffset * 60 * 1000);
    
        // Day of the year in IST
        const start = new Date(nowIST.getFullYear(), 0, 0);
        const diff = nowIST - start;
        const oneDay = 1000 * 60 * 60 * 24;
        const dayOfYear = Math.floor(diff / oneDay);
    
        const index = dayOfYear % words.length;
        wordOfTheDay = words[index].toLowerCase();
        console.log("Today's word:", wordOfTheDay);
      } catch (error) {
        console.error("Failed to load words.json", error);
      }
    }
    getWordOfTheDay();
    
    // Initialize board
    for(let i=0;i<6;i++){
      let row=document.createElement("div");
      row.classList.add("row");
      for(let j=0;j<5;j++){
        let tile=document.createElement("div");
        tile.classList.add("tile");
        row.appendChild(tile);
      }
      board.appendChild(row);
    }

    // Countdown timer - Fixed calculation
    function updateCountdown() {
      const now = new Date();
      
      // Create IST time (UTC+5:30)
      const istTime = new Date(now.getTime() + (5.5 * 60 * 60 * 1000));
      
      // Get hours, minutes, seconds in IST
      const istHours = istTime.getUTCHours();
      const istMinutes = istTime.getUTCMinutes();
      const istSeconds = istTime.getUTCSeconds();
      
      // Calculate time until next IST midnight (24:00:00)
      const hoursLeft = 23 - istHours;
      const minutesLeft = 59 - istMinutes;
      const secondsLeft = 59 - istSeconds;
      
      countdownElement.textContent = `Next word in: ${hoursLeft.toString().padStart(2, '0')}:${minutesLeft.toString().padStart(2, '0')}:${secondsLeft.toString().padStart(2, '0')}`;
      
      // If it's exactly midnight IST, refresh the page
      if (hoursLeft === 23 && minutesLeft === 59 && secondsLeft === 59) {
        setTimeout(() => {
          location.reload();
        }, 1000);
      }
    }
    
    // Update countdown every second
    setInterval(updateCountdown, 1000);
    updateCountdown(); // Initial call

    // Input handling
    document.addEventListener("keydown", e => handleInput(e.key));
    document.querySelectorAll("#keyboard button").forEach(btn=>{
      btn.addEventListener("click", ()=>{
        let key = btn.textContent;
        if(btn.id === "enter") key = "Enter";
        if(btn.id === "backspace") key = "Backspace";
        handleInput(key);
      });
    });

    function handleInput(key){
      if(gameOver) return;
      if(/^[a-zA-Z]$/.test(key) && currentTile < 5){
        let tile = board.children[currentRow].children[currentTile];
        tile.textContent = key.toUpperCase();
        tile.classList.add("filled");
        currentTile++;
      } else if(key === "Backspace" && currentTile > 0){
        currentTile--;
        let tile = board.children[currentRow].children[currentTile];
        tile.textContent = "";
        tile.classList.remove("filled");
      } else if(key === "Enter" && currentTile === 5) checkWord();
    }

    function checkWord(){
      let row = board.children[currentRow];
      let guess = "";
      for(let i=0;i<5;i++) guess += row.children[i].textContent.toLowerCase();

      for(let i=0;i<5;i++){
        if(guess[i] === wordOfTheDay[i]) row.children[i].classList.add("correct");
        else if(wordOfTheDay.includes(guess[i])) row.children[i].classList.add("present");
        else row.children[i].classList.add("absent");
      }

      if(guess === wordOfTheDay){ message.textContent = "üéâ You guessed it!"; gameOver = true; }
      else if(++currentRow === 6){ message.textContent = `‚ùå The word was: ${wordOfTheDay.toUpperCase()}`; gameOver = true; }
      currentTile = 0;
    }

    // Dark/Light mode
    document.getElementById("theme-toggle").addEventListener("click",()=>{
      document.body.classList.toggle("dark");
      document.getElementById("theme-toggle").textContent = document.body.classList.contains("dark") ? "‚òÄÔ∏è Light Mode" : "üåô Dark Mode";
    });
  </script>
</body>
</html>
